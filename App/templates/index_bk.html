<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>新型冠状病毒肺炎</title>
    <link rel="stylesheet" href="{{url_for('static',filename='bootstrap-4.4.1-dist/css/bootstrap.css')}}" >
    <link rel="stylesheet" href="{{url_for('static',filename='bootstrap-select-1.13.12/css/bootstrap-select.min.css')}}" >
    <script src="{{url_for('static',filename='incubator-echarts-4.6.0/dist/echarts.js')}}"></script>
    <script src="{{url_for('static',filename='jquery-3.4.1.min.js')}}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="{{url_for('static',filename='bootstrap-4.4.1-dist/js/bootstrap.js')}}"></script>
    <script src="{{url_for('static',filename='bootstrap-select-1.13.12/js/bootstrap-select.min.js')}}"></script>
</head>
<body>
<div class="main_content">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    	<div class="my-0 mr-md-auto font-weight-normal text-white" >
            <h4></h4>
            <h4>新型冠状病毒肺炎中医药推荐方分析系统</h4>
            <h4></h4>
        </div>
        <!-- <a class="navbar-brand text-white">南京中医药大学干部在线学习考试系统</a> -->
        <h6 class="text-white"></h6>
    </nav>

    <div class="container-fluid" style="padding-top: 80px;">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
                <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="input something"
                           aria-label="Recipient's username" aria-describedby="button-addon2">
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="button" id="button-addon2">Search</button>
                    </div>
                </div>
            </div>
            <div class="col-md-3"></div>
        </div>
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
                <div class="form-group">
                    <select id="herb" class="selectpicker form-control">
                    </select>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                     <div id="xing" class="form-control" style="height:400px;"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                     <div id="wei" class="form-control" style="height:400px;"></div>
                </div>
            </div>
        </div>
    </div>

</div>
<script type="text/javascript">
    var result = {{data |tojson}};
    $(function () {
        if (JSON.stringify(result) == '{}') {
            console.log('return null');
        } else {
            draw_echarts_bar(result);
        }
    });
    function draw_echarts_bar(result) {
        var xing_title = result.xing_list;
        var legend_data = result.legend_data_list;
        var xing_result_list = result.xing_result_list;
        var wei_title = result.wei_list;
        var wei_result_list = result.wei_result_list;
        var series_data = new Array();
        var series_data_wei = new Array();

        xing_result_list.forEach((item,index,array)=>{
            //执行代码
            var series_data_content;
            if(index > 0){
                series_data_content = {'name': legend_data[index], 'type': 'bar', 'label': labelOption, 'data': item };
            }else{
                series_data_content = {'name': legend_data[index], 'type': 'bar', 'barGap': 0, 'label': labelOption, 'data': item };
            }
            series_data.push(series_data_content);
        });

        wei_result_list.forEach((item,index,array)=>{
            //执行代码
            var series_data_content_wei;
            if(index > 0){
                series_data_content_wei = {'name': legend_data[index], 'type': 'bar', 'label': labelOption, 'data': item };
            }else{
                series_data_content_wei = {'name': legend_data[index], 'type': 'bar', 'barGap': 0, 'label': labelOption, 'data': item };
            }
            series_data_wei.push(series_data_content_wei);
        });

        // 基于准备好的dom，初始化echarts实例
        var app = echarts.init(document.getElementById('xing'));
        app.configParameters = {
            rotate: {
                min: -90,
                max: 90
            },
            align: {
                options: {
                    left: 'left',
                    center: 'center',
                    right: 'right'
                }
            },
            verticalAlign: {
                options: {
                    top: 'top',
                    middle: 'middle',
                    bottom: 'bottom'
                }
            },
            position: {
                options: echarts.util.reduce(posList, function (map, pos) {
                    map[pos] = pos;
                    return map;
                }, {})
            },
            distance: {
                min: 0,
                max: 100
            }
        };

        app.config = {
            rotate: 90,
            align: 'left',
            verticalAlign: 'middle',
            position: 'insideBottom',
            distance: 15,
            onChange: function () {
                var labelOption = {
                    normal: {
                        rotate: app.config.rotate,
                        align: app.config.align,
                        verticalAlign: app.config.verticalAlign,
                        position: app.config.position,
                        distance: app.config.distance
                    }
                };
                myChart.setOption({
                    series: [{
                        label: labelOption
                    }, {
                        label: labelOption
                    }, {
                        label: labelOption
                    }, {
                        label: labelOption
                    }]
                });
            }
        };
        var posList = [
            'left', 'right', 'top', 'bottom',
            'inside',
            'insideTop', 'insideLeft', 'insideRight', 'insideBottom',
            'insideTopLeft', 'insideTopRight', 'insideBottomLeft', 'insideBottomRight'
        ];
        var labelOption = {
            show: true,
            position: app.config.position,
            distance: app.config.distance,
            align: app.config.align,
            verticalAlign: app.config.verticalAlign,
            rotate: app.config.rotate,
            formatter: '{c}  {name|{a}}',
            fontSize: 16,
            rich: {
                name: {
                    textBorderColor: '#fff'
                }
            }
        };
        option = {
            color: ['#003366', '#006699', '#4cabce', '#e5323e', '#e01b29'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {
                data: legend_data   //['Forest', 'Steppe', 'Desert', 'Wetland']
            },
            toolbox: {
                show: true,
                orient: 'vertical',
                left: 'right',
                top: 'center',
                feature: {
                    mark: {show: true},
                    dataView: {show: true, readOnly: false},
                    magicType: {show: true, type: ['line', 'bar', 'stack', 'tiled']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            xAxis: [
                {
                    type: 'category',
                    axisTick: {show: false},
                    data: xing_title    // 横坐标
                }
            ],
            yAxis: [
                {
                    type: 'value'
                }
            ],
            series: series_data
        };
        // 使用刚指定的配置项和数据显示图表。
        app.setOption(option);


        var app_wei = echarts.init(document.getElementById('wei'));
        app_wei.configParameters = {
            rotate: {
                min: -90,
                max: 90
            },
            align: {
                options: {
                    left: 'left',
                    center: 'center',
                    right: 'right'
                }
            },
            verticalAlign: {
                options: {
                    top: 'top',
                    middle: 'middle',
                    bottom: 'bottom'
                }
            },
            position: {
                options: echarts.util.reduce(posList, function (map, pos) {
                    map[pos] = pos;
                    return map;
                }, {})
            },
            distance: {
                min: 0,
                max: 100
            }
        };

        app_wei.config = {
            rotate: 90,
            align: 'left',
            verticalAlign: 'middle',
            position: 'insideBottom',
            distance: 15,
            onChange: function () {
                var labelOption = {
                    normal: {
                        rotate: app.config.rotate,
                        align: app.config.align,
                        verticalAlign: app.config.verticalAlign,
                        position: app.config.position,
                        distance: app.config.distance
                    }
                };
                myChart.setOption({
                    series: [{
                        label: labelOption
                    }, {
                        label: labelOption
                    }, {
                        label: labelOption
                    }, {
                        label: labelOption
                    }]
                });
            }
        };
        var posList = [
            'left', 'right', 'top', 'bottom',
            'inside',
            'insideTop', 'insideLeft', 'insideRight', 'insideBottom',
            'insideTopLeft', 'insideTopRight', 'insideBottomLeft', 'insideBottomRight'
        ];
        var labelOption = {
            show: true,
            position: app.config.position,
            distance: app.config.distance,
            align: app.config.align,
            verticalAlign: app.config.verticalAlign,
            rotate: app.config.rotate,
            formatter: '{c}  {name|{a}}',
            fontSize: 16,
            rich: {
                name: {
                    textBorderColor: '#fff'
                }
            }
        };
        option_wei = {
            color: ['#003366', '#006699', '#4cabce', '#e5323e', '#e01b29'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {
                data: legend_data   //['Forest', 'Steppe', 'Desert', 'Wetland']
            },
            toolbox: {
                show: true,
                orient: 'vertical',
                left: 'right',
                top: 'center',
                feature: {
                    mark: {show: true},
                    dataView: {show: true, readOnly: false},
                    magicType: {show: true, type: ['line', 'bar', 'stack', 'tiled']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            xAxis: [
                {
                    type: 'category',
                    axisTick: {show: false},
                    data: wei_title    // 横坐标
                }
            ],
            yAxis: [
                {
                    type: 'value'
                }
            ],
            series: series_data_wei
        };
        // 使用刚指定的配置项和数据显示图表。
        app_wei.setOption(option_wei);
    }

    </script>
</body>
</html>